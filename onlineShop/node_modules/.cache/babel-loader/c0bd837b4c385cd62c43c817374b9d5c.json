{"remainingRequest":"C:\\Users\\admin\\Desktop\\lzc_website\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\admin\\Desktop\\lzc_website\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\admin\\Desktop\\lzc_website\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\templateLoader.js??ref--6!C:\\Users\\admin\\Desktop\\lzc_website\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\admin\\Desktop\\lzc_website\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!C:\\Users\\admin\\Desktop\\lzc_website\\src\\views\\orderConfirmation\\Order.vue?vue&type=template&id=5c864280&scoped=true","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\lzc_website\\src\\views\\orderConfirmation\\Order.vue","mtime":1615972836000},{"path":"C:\\Users\\admin\\Desktop\\lzc_website\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\lzc_website\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\lzc_website\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\lzc_website\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\templateLoader.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\lzc_website\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\lzc_website\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLnRvLWZpeGVkLmpzIjsKaW1wb3J0IHsgdG9EaXNwbGF5U3RyaW5nIGFzIF90b0Rpc3BsYXlTdHJpbmcsIGNyZWF0ZVZOb2RlIGFzIF9jcmVhdGVWTm9kZSwgY3JlYXRlVGV4dFZOb2RlIGFzIF9jcmVhdGVUZXh0Vk5vZGUsIHdpdGhNb2RpZmllcnMgYXMgX3dpdGhNb2RpZmllcnMsIG9wZW5CbG9jayBhcyBfb3BlbkJsb2NrLCBjcmVhdGVCbG9jayBhcyBfY3JlYXRlQmxvY2ssIGNyZWF0ZUNvbW1lbnRWTm9kZSBhcyBfY3JlYXRlQ29tbWVudFZOb2RlLCByZXNvbHZlQ29tcG9uZW50IGFzIF9yZXNvbHZlQ29tcG9uZW50LCBGcmFnbWVudCBhcyBfRnJhZ21lbnQsIHdpdGhTY29wZUlkIGFzIF93aXRoU2NvcGVJZCwgcHVzaFNjb3BlSWQgYXMgX3B1c2hTY29wZUlkLCBwb3BTY29wZUlkIGFzIF9wb3BTY29wZUlkIH0gZnJvbSAidnVlIjsKCnZhciBfd2l0aElkID0gLyojX19QVVJFX18qL193aXRoU2NvcGVJZCgiZGF0YS12LTVjODY0MjgwIik7CgpfcHVzaFNjb3BlSWQoImRhdGEtdi01Yzg2NDI4MCIpOwoKdmFyIF9ob2lzdGVkXzEgPSB7CiAgY2xhc3M6ICJvcmRlciIKfTsKdmFyIF9ob2lzdGVkXzIgPSB7CiAgY2xhc3M6ICJvcmRlcl9fcHJpY2UiCn07Cgp2YXIgX2hvaXN0ZWRfMyA9IC8qI19fUFVSRV9fKi9fY3JlYXRlVGV4dFZOb2RlKCIg5a6e5LuY6YeR6aKdOiAiKTsKCnZhciBfaG9pc3RlZF80ID0gLyojX19QVVJFX18qL19jcmVhdGVWTm9kZSgiaDMiLCB7CiAgY2xhc3M6ICJtYXNrX19jb250ZW50X190aXRsZSIKfSwgIuaPkOS6pCBvciDlj5bmtojvvJ8iLCAtMSk7Cgp2YXIgX2hvaXN0ZWRfNSA9IC8qI19fUFVSRV9fKi9fY3JlYXRlVk5vZGUoInAiLCB7CiAgY2xhc3M6ICJtYXNrX19jb250ZW50X19kZXNjIgp9LCAi6K+35bC95b+r6YCJ5oupIiwgLTEpOwoKdmFyIF9ob2lzdGVkXzYgPSB7CiAgY2xhc3M6ICJtYXNrX19jb250ZW50X19idG5zIgp9OwoKX3BvcFNjb3BlSWQoKTsKCmV4cG9ydCB2YXIgcmVuZGVyID0gLyojX19QVVJFX18qL193aXRoSWQoZnVuY3Rpb24gKF9jdHgsIF9jYWNoZSwgJHByb3BzLCAkc2V0dXAsICRkYXRhLCAkb3B0aW9ucykgewogIHZhciBfY29tcG9uZW50X1RvYXN0ID0gX3Jlc29sdmVDb21wb25lbnQoIlRvYXN0Iik7CgogIHJldHVybiBfb3BlbkJsb2NrKCksIF9jcmVhdGVCbG9jayhfRnJhZ21lbnQsIG51bGwsIFtfY3JlYXRlVk5vZGUoImRpdiIsIF9ob2lzdGVkXzEsIFtfY3JlYXRlVk5vZGUoImRpdiIsIF9ob2lzdGVkXzIsIFtfaG9pc3RlZF8zLCBfY3JlYXRlVk5vZGUoImIiLCBudWxsLCAiwqUiICsgX3RvRGlzcGxheVN0cmluZygoKyRzZXR1cC5jYWxjdWxhdGlvbnMucHJpY2UgKyAkc2V0dXAuaXRlbS5leHByZXNzUHJpY2UpLnRvRml4ZWQoMikpICsgIiAo5bey5ZCr6YWN6YCB6LS5IiArIF90b0Rpc3BsYXlTdHJpbmcoJHNldHVwLml0ZW0uZXhwcmVzc1ByaWNlKSArICLlhYMpIiwgMSldKSwgX2NyZWF0ZVZOb2RlKCJkaXYiLCB7CiAgICBjbGFzczogIm9yZGVyX19idG4iLAogICAgb25DbGljazogX2NhY2hlWzFdIHx8IChfY2FjaGVbMV0gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiAkc2V0dXAuaGFuZGxlU3VibWl0Q2xpY2sodHJ1ZSk7CiAgICB9KQogIH0sICLmj5DkuqTorqLljZUiKV0pLCAkc2V0dXAuc2hvd0NvbmZpcm0gPyAoX29wZW5CbG9jaygpLCBfY3JlYXRlQmxvY2soImRpdiIsIHsKICAgIGtleTogMCwKICAgIGNsYXNzOiAibWFzayIsCiAgICBvbkNsaWNrOiBfY2FjaGVbNV0gfHwgKF9jYWNoZVs1XSA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuICRzZXR1cC5oYW5kbGVTdWJtaXRDbGljayhmYWxzZSk7CiAgICB9KQogIH0sIFtfY3JlYXRlVk5vZGUoImRpdiIsIHsKICAgIGNsYXNzOiAibWFza19fY29udGVudCIsCiAgICBvbkNsaWNrOiBfY2FjaGVbNF0gfHwgKF9jYWNoZVs0XSA9IF93aXRoTW9kaWZpZXJzKGZ1bmN0aW9uICgpIHt9LCBbInN0b3AiXSkpCiAgfSwgW19ob2lzdGVkXzQsIF9ob2lzdGVkXzUsIF9jcmVhdGVWTm9kZSgiZGl2IiwgX2hvaXN0ZWRfNiwgW19jcmVhdGVWTm9kZSgiZGl2IiwgewogICAgY2xhc3M6ICJtYXNrX19jb250ZW50X19idG4gbWFza19fY29udGVudF9fYnRuLS1maXJzdCIsCiAgICBvbkNsaWNrOiBfY2FjaGVbMl0gfHwgKF9jYWNoZVsyXSA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuICRzZXR1cC5oYW5kbGVDb25maXJtT3JkZXIodHJ1ZSk7CiAgICB9KQogIH0sICLlj5bmtojorqLljZUiKSwgX2NyZWF0ZVZOb2RlKCJkaXYiLCB7CiAgICBjbGFzczogIm1hc2tfX2NvbnRlbnRfX2J0biBtYXNrX19jb250ZW50X19idG4tLWxhc3QiLAogICAgb25DbGljazogX2NhY2hlWzNdIHx8IChfY2FjaGVbM10gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiAkc2V0dXAuaGFuZGxlQ29uZmlybU9yZGVyKGZhbHNlKTsKICAgIH0pCiAgfSwgIuehruiupOaXoOivryIpXSldKV0pKSA6IF9jcmVhdGVDb21tZW50Vk5vZGUoIiIsIHRydWUpLCAkc2V0dXAuc2hvdyA/IChfb3BlbkJsb2NrKCksIF9jcmVhdGVCbG9jayhfY29tcG9uZW50X1RvYXN0LCB7CiAgICBrZXk6IDEsCiAgICBtZXNzYWdlOiAkc2V0dXAudG9hc3RNZXNzYWdlCiAgfSwgbnVsbCwgOCwgWyJtZXNzYWdlIl0pKSA6IF9jcmVhdGVDb21tZW50Vk5vZGUoIiIsIHRydWUpXSwgNjQpOwp9KTs="},{"version":3,"sources":["C:\\Users\\admin\\Desktop\\lzc_website\\src\\views\\orderConfirmation\\Order.vue"],"names":[],"mappings":";;;;;;;;AACO,EAAA,KAAK,EAAC;;;AACJ,EAAA,KAAK,EAAC;;;+CAAe,S;;8BAiBxB,YAAA,CAA+C,IAA/C,EAA+C;AAA3C,EAAA,KAAK,EAAC;AAAqC,CAA/C,EAAiC,WAAjC,EAA0C,CAAA,CAA1C,C;;8BACA,YAAA,CAAwC,GAAxC,EAAwC;AAArC,EAAA,KAAK,EAAC;AAA+B,CAAxC,EAA+B,OAA/B,EAAoC,CAAA,CAApC,C;;;AACK,EAAA,KAAK,EAAC;;;;;;;;sDApBf,YAAA,CAQM,KARN,EAAA,UAAA,EAQM,CAPJ,YAAA,CAEM,KAFN,EAAA,UAAA,EAEM,C,UAAA,EADE,YAAA,CAAkG,GAAlG,EAAkG,IAAlG,EAAG,MAAC,gBAAA,CAAA,CAAA,CAAK,MAAA,CAAA,YAAA,CAAa,KAAlB,GAA0B,MAAA,CAAA,IAAA,CAAK,YAA/B,EAA6C,OAA7C,CAAoD,CAApD,CAAA,CAAD,GAA2D,SAA3D,GAAkE,gBAAA,CAAG,MAAA,CAAA,IAAA,CAAK,YAAR,CAAlE,GAAyF,IAA5F,EAA8F,CAA9F,CACF,CAFN,CAOI,EAJJ,YAAA,CAGW,KAHX,EAGW;AAFT,IAAA,KAAK,EAAC,YAEG;AADR,IAAA,OAAK,EAAA,MAAA,CAAA,CAAA,CAAA,KAAA,MAAA,CAAA,CAAA,CAAA,GAAA;AAAA,aAAQ,MAAA,CAAA,iBAAA,CAAiB,IAAjB,CAAR;AAAA,KAAA;AACG,GAHX,EAGC,MAHD,CAII,CARN,C,EAWQ,MAAA,CAAA,W,kBAFR,YAAA,CAsBM,KAtBN,EAsBM;UAAA;AArBJ,IAAA,KAAK,EAAC,MAqBF;AAnBH,IAAA,OAAK,EAAA,MAAA,CAAA,CAAA,CAAA,KAAA,MAAA,CAAA,CAAA,CAAA,GAAA;AAAA,aAAQ,MAAA,CAAA,iBAAA,CAAiB,KAAjB,CAAR;AAAA,KAAA;AAmBF,GAtBN,E,CAKE,YAAA,CAgBM,KAhBN,EAgBM;AAfJ,IAAA,KAAK,EAAC,eAeF;AAdH,IAAA,OAAK,EAAA,MAAA,CAAA,CAAA,CAAA,KAAA,MAAA,CAAA,CAAA,CAAA,GAAA,cAAA,CAAN,YAAA,CAAW,CAAL,EAAK,CAAA,MAAA,CAAL,CAAA;AAcF,GAhBN,E,CAIE,U,EACA,U,EACA,YAAA,CASM,KATN,EAAA,UAAA,EASM,CARJ,YAAA,CAGW,KAHX,EAGW;AAFT,IAAA,KAAK,EAAC,8CAEG;AADR,IAAA,OAAK,EAAA,MAAA,CAAA,CAAA,CAAA,KAAA,MAAA,CAAA,CAAA,CAAA,GAAA;AAAA,aAAQ,MAAA,CAAA,kBAAA,CAAkB,IAAlB,CAAR;AAAA,KAAA;AACG,GAHX,EAGC,MAHD,CAQI,EAJJ,YAAA,CAGW,KAHX,EAGW;AAFT,IAAA,KAAK,EAAC,6CAEG;AADR,IAAA,OAAK,EAAA,MAAA,CAAA,CAAA,CAAA,KAAA,MAAA,CAAA,CAAA,CAAA,GAAA;AAAA,aAAQ,MAAA,CAAA,kBAAA,CAAkB,KAAlB,CAAR;AAAA,KAAA;AACG,GAHX,EAGC,MAHD,CAII,CATN,C,CANF,C,CALF,C,mCAwBQ,MAAA,CAAA,I,kBADR,YAAA,CAGE,gBAHF,EAGE;UAAA;AADC,IAAA,OAAO,EAAE,MAAA,CAAA;AACV,GAHF,E,IAAA,E,CAAA,E,WAAA,C","sourcesContent":["<template>\n  <div class=\"order\">\n    <div class=\"order__price\">\n      实付金额: <b>¥{{ (+calculations.price + item.expressPrice).toFixed(2) }} (已含配送费{{ item.expressPrice }}元)</b>\n    </div>\n    <div\n      class=\"order__btn\"\n      @click=\"() => handleSubmitClick(true)\"\n    >提交订单</div>\n  </div>\n  <div\n    class=\"mask\"\n    v-if=\"showConfirm\"\n    @click=\"() => handleSubmitClick(false)\"\n  >\n    <div\n      class=\"mask__content\"\n      @click.stop\n    >\n      <h3 class=\"mask__content__title\">提交 or 取消？</h3>\n      <p class=\"mask__content__desc\">请尽快选择</p>\n      <div class=\"mask__content__btns\">\n        <div\n          class=\"mask__content__btn mask__content__btn--first\"\n          @click=\"() => handleConfirmOrder(true)\"\n        >取消订单</div>\n        <div\n          class=\"mask__content__btn mask__content__btn--last\"\n          @click=\"() => handleConfirmOrder(false)\"\n        >确认无误</div>\n      </div>\n    </div>\n  </div>\n  <Toast\n    v-if=\"show\"\n    :message=\"toastMessage\"\n  />\n</template>\n\n<script>\nimport { ref, reactive, toRefs } from 'vue'\nimport { useCommonCartEffect } from '../../effects/cartEffects'\nimport { post, get } from '../../utils/request'\nimport { useRoute, useRouter } from 'vue-router'\nimport { useStore } from 'vuex'\nimport Toast, { useToastEffect } from '../../components/Toast'\n\n// 订单相关逻辑\nconst useOrderEffect = (showToast) => {\n  const store = useStore()\n  const router = useRouter()\n  const route = useRoute()\n  const shopId = route.params.id\n  const userInfo = JSON.parse(localStorage.getItem('user'))\n  const addressId = localStorage.getItem('orderAddressId')\n  const { calculations, shopName, productList } = useCommonCartEffect(shopId)\n  const handleConfirmOrder = async (isCanceled) => {\n    const products = []\n    // eslint-disable-next-line prefer-const\n    for (let i in productList.value) {\n      const product = productList.value[i]\n      products.push({ id: parseInt(product.id, 10), num: product.count })\n    }\n    try {\n      const result = await post('/order', {\n        userId: userInfo.id,\n        addressId,\n        shopId,\n        shopName: shopName.value,\n        isCanceled,\n        products\n      })\n      if (result === 'ok') {\n        store.commit('cleanCartData', shopId)\n        router.push({ name: 'OrderList' })\n      }\n    } catch (e) {\n      showToast('请求失败!')\n    }\n  }\n  return { handleConfirmOrder, calculations }\n}\n\n// 提交相关逻辑\nconst useSubmitEffect = (showToast) => {\n  const showConfirm = ref(false)\n  const handleSubmitClick = (status) => {\n    if (localStorage.getItem('orderAddressId') !== 'undefined') {\n      showConfirm.value = status\n    } else {\n      showToast('请添加地址!')\n    }\n  }\n  return { handleSubmitClick, showConfirm }\n}\n\n// 获取当前商铺信息\nconst useShopInfoEffect = () => {\n  const route = useRoute()\n  const data = reactive({ item: {} })\n  const getItemData = async () => {\n    const result = await get('/showShop', { id: route.params.id })\n    data.item = result\n  }\n  const { item } = toRefs(data)\n  return { item, getItemData }\n}\n\nexport default ({\n  name: 'Order',\n  components: { Toast },\n  setup () {\n    const { toastMessage, showToast, show } = useToastEffect()\n    const { handleConfirmOrder, calculations } = useOrderEffect(showToast)\n    const { handleSubmitClick, showConfirm } = useSubmitEffect(showToast)\n    const { item, getItemData } = useShopInfoEffect()\n    const AddressId = localStorage.getItem('orderAddressId')\n    getItemData()\n    return { AddressId, calculations, handleConfirmOrder, showConfirm, handleSubmitClick, show, toastMessage, item }\n  }\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.order {\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  height: 0.49rem;\n  line-height: 0.49rem;\n  background: #fff;\n  &__price {\n    flex: 1;\n    text-indent: 0.24rem;\n    font-size: 0.14rem;\n    color: #333;\n  }\n  &__btn {\n    width: 0.98rem;\n    background: #0091ff;\n    color: #fff;\n    text-align: center;\n    font-size: 0.14rem;\n  }\n}\n\n.mask {\n  z-index: 1;\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  background: rgba(0, 0, 0, 0.5);\n  &__content {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    width: 3rem;\n    height: 1.56rem;\n    background: #fff;\n    text-align: center;\n    border-radius: 0.04rem;\n    &__title {\n      margin: 0.24rem 0 0 0;\n      line-height: 0.26rem;\n      font-size: 0.18rem;\n      color: #333;\n    }\n    &__desc {\n      margin: 0.08rem 0 0 0;\n      font-size: 0.14rem;\n      color: #666666;\n    }\n    &__btns {\n      display: flex;\n      margin: 0.24rem 0.58rem;\n    }\n    &__btn {\n      flex: 1;\n      width: 0.8rem;\n      line-height: 0.32rem;\n      border-radius: 0.16rem;\n      font-size: 0.14rem;\n      &--first {\n        margin-right: 0.12rem;\n        border: 0.01rem solid #4fb0f9;\n        color: #4fb0f9;\n      }\n      &--last {\n        margin-left: 0.12rem;\n        background: #4fb0f9;\n        color: #fff;\n      }\n    }\n  }\n}\n</style>\n"],"sourceRoot":""}]}