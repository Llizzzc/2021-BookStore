{"remainingRequest":"C:\\Users\\admin\\Desktop\\lzc_website\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!C:\\Users\\admin\\Desktop\\lzc_website\\src\\views\\usernameChange\\UsernameChange.vue?vue&type=template&id=3b82ca25&scoped=true","dependencies":[{"path":"C:\\Users\\admin\\Desktop\\lzc_website\\src\\views\\usernameChange\\UsernameChange.vue","mtime":1618209113459},{"path":"C:\\Users\\admin\\Desktop\\lzc_website\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\lzc_website\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\admin\\Desktop\\lzc_website\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\templateLoader.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\lzc_website\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\admin\\Desktop\\lzc_website\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQogIDxkaXYNCiAgICBjbGFzcz0iaWNvbmZvbnQgdGl0bGVfX2JhY2siDQogICAgQGNsaWNrPSJoYW5kbGVCYWNrQ2xpY2siDQogID4mI3hlNjAyOzwvZGl2Pg0KICA8ZGl2IGNsYXNzPSJ3cmFwcGVyIj4NCiAgICA8ZGl2IGNsYXNzPSJ3cmFwcGVyX19pbnB1dCI+DQogICAgICA8aW5wdXQNCiAgICAgICAgY2xhc3M9IndyYXBwZXJfX2lucHV0X19jb250ZW50Ig0KICAgICAgICBwbGFjZWhvbGRlcj0i6K+36L6T5YWl5paw55So5oi35ZCNIg0KICAgICAgICB2LW1vZGVsPSJ1c2VybmFtZSINCiAgICAgIC8+DQogICAgPC9kaXY+DQogICAgPGRpdg0KICAgICAgY2xhc3M9IndyYXBwZXJfX2NoYW5nZS1idXR0b24iDQogICAgICBAY2xpY2s9ImhhbmRsZUNoYW5nZSINCiAgICA+5L+u5pS5PC9kaXY+DQogICAgPFRvYXN0DQogICAgICB2LWlmPSJzaG93Ig0KICAgICAgOm1lc3NhZ2U9InRvYXN0TWVzc2FnZSINCiAgICAvPg0KICA8L2Rpdj4NCg=="},{"version":3,"sources":["C:\\Users\\admin\\Desktop\\lzc_website\\src\\views\\usernameChange\\UsernameChange.vue"],"names":[],"mappings":";EACE,CAAC,CAAC,CAAC;IACD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACzB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACd,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAClB,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACzB,CAAC,CAAC,CAAC,CAAC,CAAC;QACH,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC9B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACpB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACnB,CAAC;IACH,CAAC,CAAC,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;MACD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAC7B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACtB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACR,CAAC,CAAC,CAAC,CAAC,CAAC;MACH,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACV,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACxB,CAAC;EACH,CAAC,CAAC,CAAC,CAAC,CAAC","file":"C:/Users/admin/Desktop/lzc_website/src/views/usernameChange/UsernameChange.vue","sourceRoot":"","sourcesContent":["<template>\r\n  <div\r\n    class=\"iconfont title__back\"\r\n    @click=\"handleBackClick\"\r\n  >&#xe602;</div>\r\n  <div class=\"wrapper\">\r\n    <div class=\"wrapper__input\">\r\n      <input\r\n        class=\"wrapper__input__content\"\r\n        placeholder=\"请输入新用户名\"\r\n        v-model=\"username\"\r\n      />\r\n    </div>\r\n    <div\r\n      class=\"wrapper__change-button\"\r\n      @click=\"handleChange\"\r\n    >修改</div>\r\n    <Toast\r\n      v-if=\"show\"\r\n      :message=\"toastMessage\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { useRouter } from 'vue-router'\r\nimport { reactive, toRefs } from 'vue'\r\nimport { post } from '../../utils/request'\r\nimport Toast, { useToastEffect } from '../../components/Toast'\r\n\r\n// 改密逻辑\r\nconst useChangeEffect = (showToast) => {\r\n  const router = useRouter()\r\n  const userInfo = JSON.parse(localStorage.getItem('user'))\r\n  const data = reactive({\r\n    username: ''\r\n  })\r\n  const handleChange = async () => {\r\n    if (data.username === '') {\r\n      showToast('用户名不能为空!')\r\n    } else {\r\n      try {\r\n        const result = await post('/usernamechange', {\r\n          username: data.username,\r\n          id: userInfo.id\r\n        })\r\n        if (typeof result !== 'string') {\r\n          const userInfo = {\r\n            id: result.id,\r\n            name: result.username\r\n          }\r\n          localStorage.setItem('user', JSON.stringify(userInfo))\r\n          showToast('修改成功!')\r\n          setTimeout(() => {\r\n            router.push({ name: 'PersonalInfo' })\r\n          }, 2000)\r\n        } else if (result === 'exist') {\r\n          showToast('该用户名已存在!')\r\n        } else if (result === 'again') {\r\n          showToast('新旧用户名不能相同!')\r\n        }\r\n      } catch (e) {\r\n        showToast('请求失败!')\r\n      }\r\n    }\r\n  }\r\n  const { username } = toRefs(data)\r\n  return { username, handleChange }\r\n}\r\n\r\n// 点击回退\r\nconst useHandleBack = () => {\r\n  const router = useRouter()\r\n  const handleBackClick = () => { router.back() }\r\n  return handleBackClick\r\n}\r\n\r\nexport default {\r\n  name: 'PswChange',\r\n  components: { Toast },\r\n  setup () {\r\n    const { show, toastMessage, showToast } = useToastEffect()\r\n    const handleBackClick = useHandleBack()\r\n    const { username, handleChange } = useChangeEffect(showToast)\r\n    return { username, handleChange, show, toastMessage, handleBackClick }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.wrapper {\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 0;\r\n  right: 0;\r\n  transform: translateY(-50%);\r\n  &__input {\r\n    height: 0.48rem;\r\n    margin: 0 0.4rem 0.16rem 0.4rem;\r\n    padding: 0 0.16rem;\r\n    background: #f9f9f9;\r\n    border: 0.01rem solid rgba(0, 0, 0, 0.1);\r\n    border-radius: 0.06rem;\r\n    &__content {\r\n      margin-top: 0.12rem;\r\n      line-height: 0.22rem;\r\n      border: none;\r\n      outline: none;\r\n      width: 100%;\r\n      background: none;\r\n      font-size: 0.16rem;\r\n      color: rgba(0, 0, 0, 0.5);\r\n      &::placeholder {\r\n        color: rgba(0, 0, 0, 0.5);\r\n      }\r\n    }\r\n  }\r\n  &__change-button {\r\n    margin: 0.32rem 0.4rem 0 0.4rem;\r\n    line-height: 0.48rem;\r\n    background: #0091ff;\r\n    box-shadow: 0 0.04rem 0.08rem 0 rgba(0, 145, 255, 0.32);\r\n    border-radius: 0.04rem;\r\n    border-radius: 0.04rem;\r\n    color: #fff;\r\n    font-size: 0.16rem;\r\n    text-align: center;\r\n  }\r\n}\r\n.title__back {\r\n  display: flex;\r\n  line-height: 0.44rem;\r\n  background: #fff;\r\n  font-size: 0.16rem;\r\n  color: #333;\r\n  text-align: center;\r\n  width: 0.2rem;\r\n  margin-left: 0.18rem;\r\n  font-size: 0.2rem;\r\n  color: #b6b6b6;\r\n}\r\n</style>\r\n"]}]}